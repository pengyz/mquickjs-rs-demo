// Auto-generated Rust glue code for RIDL interfaces
use mquickjs_rs::mquickjs_ffi::{JSContext, JSValue, JS_NewString};
use std::ffi::CString;
use std::os::raw::c_int;

// Call into crate-local implementations.
// The module crate is expected to provide `crate::impls::*`.
use crate::impls::*;

// Glue implementations for functions (only zero-arg supported)
{%- for function in functions %}
#[unsafe(no_mangle)]
pub unsafe extern "C" fn js_{{ function.name|lower }}(ctx: *mut JSContext, _this_val: JSValue, _argc: c_int, _argv: *mut JSValue) -> JSValue {
    let result = {{ function.name|lower }}();
    let cstr = CString::new(result).unwrap_or_else(|_| CString::new("").unwrap());
    JS_NewString(ctx, cstr.as_ptr())
}
{%- endfor %}

// Interface implementations (stub)
{%- for interface in interfaces %}
{%- for method in interface.methods %}
pub unsafe extern "C" fn js_{{ interface.name|lower }}_{{ method.name }}(_ctx: *mut JSContext, _this_val: JSValue, _argc: c_int, _argv: *mut JSValue) -> JSValue {
    // Not implemented
    JSValue { u: Default::default(), tag: 0 }
}
{%- endfor %}
{%- endfor %}