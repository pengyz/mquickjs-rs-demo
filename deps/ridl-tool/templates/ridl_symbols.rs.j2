// Generated by ridl-tool. DO NOT EDIT.

#[allow(non_snake_case)]
mod __ridl_agg_symbols {
    // NOTE: use a function pointer type so the keepalive table is `Sync`.
    #[allow(dead_code)]
    type JsCFunction = unsafe extern "C" fn(
        ctx: *mut mquickjs_rs::mquickjs_ffi::JSContext,
        this_val: mquickjs_rs::mquickjs_ffi::JSValue,
        argc: i32,
        argv: *mut mquickjs_rs::mquickjs_ffi::JSValue,
    ) -> mquickjs_rs::mquickjs_ffi::JSValue;

    // externs for all js_* functions
{%- for module in modules %}
{%- if module.module_decl.is_some() %}
    unsafe extern "C" {
        pub fn js_{{ module.require_full_name|normalize_ident|lower }}_module_class();
    }
{%- endif %}
{%- for f in module.functions %}
    unsafe extern "C" {
        pub fn js_{{ f.name|lower }}(ctx: *mut mquickjs_rs::mquickjs_ffi::JSContext, this_val: mquickjs_rs::mquickjs_ffi::JSValue, argc: i32, argv: *mut mquickjs_rs::mquickjs_ffi::JSValue) -> mquickjs_rs::mquickjs_ffi::JSValue;
    }
{%- endfor %}

{%- for i in module.interfaces %}
{%- for m in i.methods %}
    unsafe extern "C" {
        pub fn js_{{ i.name|lower }}_{{ m.name|lower }}(ctx: *mut mquickjs_rs::mquickjs_ffi::JSContext, this_val: mquickjs_rs::mquickjs_ffi::JSValue, argc: i32, argv: *mut mquickjs_rs::mquickjs_ffi::JSValue) -> mquickjs_rs::mquickjs_ffi::JSValue;
    }
{%- endfor %}
{%- endfor %}

{%- for c in module.classes %}
{%- for m in c.methods %}
    unsafe extern "C" {
        pub fn js_{{ c.module_name|normalize_ident|lower }}_class_{{ c.name|lower }}_{{ m.name|to_snake_case }}(ctx: *mut mquickjs_rs::mquickjs_ffi::JSContext, this_val: mquickjs_rs::mquickjs_ffi::JSValue, argc: i32, argv: *mut mquickjs_rs::mquickjs_ffi::JSValue) -> mquickjs_rs::mquickjs_ffi::JSValue;
    }
{%- endfor %}
{%- endfor %}
{%- endfor %}

    #[used]
    #[allow(non_upper_case_globals)]
    pub static __ridl_keepalive_ptrs: [
        unsafe extern "C" fn(
            ctx: *mut mquickjs_rs::mquickjs_ffi::JSContext,
            this_val: mquickjs_rs::mquickjs_ffi::JSValue,
            argc: i32,
            argv: *mut mquickjs_rs::mquickjs_ffi::JSValue,
        ) -> mquickjs_rs::mquickjs_ffi::JSValue;
        0
{%- for module in modules %}
{%- if module.functions|length > 0 %}
        + {{ module.functions|length }}
{%- endif %}
{%- set mt = module.interfaces|methods_total_filter(module.classes) %}
{%- if mt > 0 %}
        + {{ mt }}
{%- endif %}
{%- endfor %}
    ] = [
{%- for module in modules %}
{%- for f in module.functions %}
        js_{{ f.name|lower }},
{%- endfor %}
{%- for i in module.interfaces %}
{%- for m in i.methods %}
        js_{{ i.name|lower }}_{{ m.name|lower }},
{%- endfor %}
{%- endfor %}
{%- for c in module.classes %}
{%- for m in c.methods %}
        js_{{ c.module_name|normalize_ident|lower }}_class_{{ c.name|lower }}_{{ m.name|to_snake_case }},
{%- endfor %}
{%- for p in c.properties %}
{%- if !(p.modifiers|is_proto_prop) && (p.modifiers|is_readonly_prop) %}
        js_{{ c.module_name|normalize_ident|lower }}_class_{{ c.name|lower }}_get_{{ p.name|to_snake_case }},
{%- endif %}
{%- endfor %}
{%- endfor %}
{%- endfor %}
    ];

    #[used]
    #[allow(non_upper_case_globals)]
    pub static __ridl_module_keepalive_ptrs: [unsafe extern "C" fn(); 0
{%- for module in modules %}
{%- if module.module_decl.is_some() %}
        + 1
{%- endif %}
{%- endfor %}
    ] = [
{%- for module in modules %}
{%- if module.module_decl.is_some() %}
        js_{{ module.require_full_name|normalize_ident|lower }}_module_class,
{%- endif %}
{%- endfor %}
    ];
}

#[inline(always)]
pub fn ensure_symbols() {
    // Force reference to keepalive table so the linker keeps referenced symbols.
    let _ = __ridl_agg_symbols::__ridl_keepalive_ptrs.as_ptr();
}

#[inline(always)]
pub fn ensure_modules() {
    // Keep module-class TU entrypoints as well.
    let _ = __ridl_agg_symbols::__ridl_module_keepalive_ptrs.as_ptr();
}
